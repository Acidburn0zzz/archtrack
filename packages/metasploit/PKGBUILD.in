# Archtrack maintainer: Evan Teitelman <teitelmanevan at gmail dot com>
# Contributor: Sabart Otto - Seberm <seberm[at]gmail[dot]com>
# Editor: Tobias Veit - nIcE <m.on.key.tobi[at]gmail[dot]com>

pkgname=%PKGNAME%
pkgver=4.6
groups=(archtrack archtrack-exploitation-tools)
pkgrel=1
pkgdesc=%PKGDESC%
depends=('ruby' 'libpcap')
optdepends=('ruby-msgpack: armitage module' 'java-runtime: msfgui' 'ruby-pg: database support' 'dradis') #sqlite
provides=('metasploit')
conflicts=('metasploit-svn')
options=('!strip')
makedepends=('subversion')
source=(http://updates.metasploit.com/data/releases/framework-latest.tar.bz2 metasploit.sh)
url="http://www.metasploit.com/"
license=('BSD')
arch=('any')
 
md5sums=('873f1cdc479c4142fb5f13028263f298'
         '5c122cab159a706dc7e91887f33985d8')

build() {
	cd $srcdir

	echo "Installing the license file..."
	mkdir -p $pkgdir/opt $pkgdir/etc/profile.d $pkgdir/usr/share/licenses/$pkgname
	install -m444 "msf3/COPYING" "$pkgdir/usr/share/licenses/${pkgname}/LICENSE"

	mv $srcdir $pkgdir/opt/$pkgname
	cp $startdir/metasploit.sh $pkgdir/etc/profile.d

	chmod 755 $pkgdir/etc/profile.d/metasploit.sh

	# Removes all .svn directories - but after it is not possible to use msfupdate tool
	#echo "Removing all .svn directories..."
	#find $pkgdir/opt/$pkgname -name ".svn" -type d -exec rm -fr {} +
} 

